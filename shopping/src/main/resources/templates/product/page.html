<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="title" content="音特"/>
    <meta name="keywords" content="音特，音特电子，话筒"/>
    <meta name="description" content="音特电子，话筒"/>
    <title>音特电子</title>
    <link rel="stylesheet" type="text/css" th:href="@{/plugins/bootstrap/css/bootstrap.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/iconfont.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/magnify.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/main.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/app.css}" >
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body data-spy="scroll" data-target="#scrollNav" data-offset="82" style="position: relative;">
<div class="wrapper">
    <!-- 通用头部-->
    <header class="header" th:include="/public/_header"></header>
    <!-- 内容区-->
    <section class="page">
        <div class="page-product">
            <div class="row">
                <div class="col-lg-5">
                    <div class="ban" id="demo1">
                        <div class="ban2" id="ban_pic1">
                            <ul>
                                <li th:each="thumbnail:${product.thumbnailSet}">
                                    <a th:href="${thumbnail.picUrl}">
                                        <img  class="zoom" th:src="${thumbnail.picUrl}" alt="">
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="min_pic">
                            <div class="prev_btn1" id="prev_btn1"><img th:src="@{/img/feel3.png}" width="9" height="18" alt="">
                            </div>
                            <div class="num clearfix" id="ban_num1">
                                <ul class="clearfix">
                                    <li th:each="thumbnail:${product.thumbnailSet}">
                                        <a href="javascript:;">
                                            <img th:src="${thumbnail.picUrl}" alt="">
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="next_btn1" id="next_btn1"><img th:src="@{/img/feel4.png}" width="9" height="18" alt="">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-7">
                    <div class="productRight">
                        <p class="productTags"><span class="productTag">音特商城</span> · <span class="productTag">家庭KARAOKE</span>
                            · <span class="productTag">KARAOKE  E2</span></p>
                        <input type="hidden" id="productId" th:value="${product.id}" />
                        <p class="productName" th:text="${product.name}">KARAOKE 点歌机 E2 ET28KH</p>
                        <p class="productWords">海量歌库，您想要的都在这里!</p>
                        <p class="productMoney" th:text="${product.priceSale}">¥1999.00</p>
                        <div class="accessories">
                            <span class="accWords">配件</span>
                            <ul class="accessoriesImgs clearfix" id="accessoriesImg">
                                <li th:each="part:${product.partsSet}">
                                    <img th:src="${part.picUrl}">
                                </li>
                            </ul>
                        </div>
                        <div class="colors">
                            <span class="colorsWords">颜色</span>
                            <ul class="chooseColors choose clearfix" id="chooseColor">
                                <li>
                                    <input name="color" type="radio" id="color1" value="黑色">
                                    <label for="color1">
                                        <span class="colorCircle black"></span>
                                        黑色
                                    </label>
                                </li>
                                <li>
                                    <input name="color" type="radio" id="color2" value="玫瑰金">
                                    <label for="color2">
                                        <span class="colorCircle rose"></span>
                                        玫瑰金
                                    </label>
                                </li>
                            </ul>
                        </div>
                        <div class="proServices">
                            <span class="colorsWords">承诺</span>
                            <div class="proService">
                                <i class="iconfont icon-tianwuliyoubaotui"></i><span>7天无理由退货</span>
                                <i class="iconfont icon-tianbaohuan"></i><span>30天包换</span>
                                <i class="iconfont icon-quanguobaoyou"></i><span>全国联保</span>
                            </div>
                        </div>
                        <div class="proBuy">
                            <div class="btn-group" role="group" aria-label="...">
                                <button type="button" class="btn btn-default" onclick="m_subtract(this)">-</button>
                                <input type="text" class="btn btn-default inputBtn" value="1" id="inputNum" onkeyup="value=(parseInt((value=value.replace(/\D/g,''))==''||parseInt((value=value.replace(/\D/g,''))==0)?'1':value,10))">
                                <button type="button" class="btn btn-default" onclick="m_add(this)">+</button>
                            </div>
                            <a class="addTo" id="addToCart" onclick="addCart(this)" >加入购物车</a>
                            <a class="addTo buyTo" id="buyNow" href="#">立即购买</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="page-detail">
            <div class="pageNav">
                <div class="container clearfix">
                    <ul class="nav detailNav clearfix" id="scrollNav">
                        <li class="active">
                            <a class="details" href="#proDetail">商品详情</a>
                        </li>
                        <li>
                            <a class="details" href="#spec">规格参数</a>
                        </li>
                        <li>
                            <a class="details" href="#askQ">常见问题</a>
                        </li>
                        <li class="pull-right">
                            <a class="addTo scrollBuyTo" href="#">立即购买</a>
                        </li>
                    </ul>

                </div>
            </div>
            <div id="content" >
                <div id="proDetail" th:include="/product/proDetail">
                </div>
                <div id="spec" th:include="/product/spec">
                </div>
                <div id="askQ" th:include="/product/askQ">
                </div>
            </div>
        </div>
    </section>
    <!-- footer-->
    <footer id="footer" th:include="/public/_footer">
    </footer>
    <!--addCartModal-->
    <div class="modal myInfoModal" tabindex="-1" role="dialog" id="addCartModal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="iconfont icon-close"></span></button>
                </div>
                <div class="modal-body text-center">
                    <div class="addSuccess">
                        <i class="iconfont icon-duigou payOk"></i>
                        <span class="f-20">商品已成功加入购物车！</span>
                    </div>
                    <div class="addCartBtn">
                        <a class="addCart_a" th:href="@{/trolley/listMyTrolley}">去结算</a>
                        <a class="goShop_a" th:href="@{/user/index}">再逛逛</a>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>
<script type="text/javascript" th:src="@{/plugins/jquery/js/jquery-2.1.3.min.js}"></script>
<script type="text/javascript" th:src="@{/plugins/bootstrap/js/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/plugins/jquery/js/jquery.easing.1.3.js}"></script>
<script type="text/javascript" th:src="@{/plugins/jquery/js/jquery-migrate-1.4.1.min.js}"></script>
<script type="text/javascript" th:src="@{/js/modernizr-custom.min.js}"></script>
<script type="text/javascript" th:src="@{/js/pic_tab.js}"></script>
<script type="text/javascript" th:src="@{/js/sdw_hw.js}"></script>
<script type="text/javascript" th:src="@{/js/main.js}"></script>
<script type="text/javascript" th:src="@{/js/app.js}"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#demo1').banqh({
            box: "#demo1",//总框架
            pic: "#ban_pic1",//大图框架
            pnum: "#ban_num1",//小图框架
            prev_btn: "#prev_btn1",//小图左箭头
            next_btn: "#next_btn1",//小图右箭头
            pop_prev: "#prev2",//弹出框左箭头
            pop_next: "#next2",//弹出框右箭头
            prev: "#prev1",//大图左箭头
            next: "#next1",//大图右箭头
            mhc: ".mhc",//朦灰层
            autoplay: false,//是否自动播放
            interTime: 5000,//图片自动切换间隔
            delayTime: 400,//切换一张图片时间
            order: 0,//当前显示的图片（从0开始）
            picdire: true,//大图滚动方向（true为水平方向滚动）
            mindire: true,//小图滚动方向（true为水平方向滚动）
            min_picnum: 5,//小图显示数量
            pop_up: false//大图是否有弹出框
        });
        $('.zoom').magnify();//初始化放大镜效果
        // 点击+号页面展开回收动效
        $('#change').on('click', function () {
            $(this).parent('.block3').toggleClass('block3-relate');
            $(this).toggleClass('rotates');
            $(this).prev('.elva').slideToggle(1500);
            $(this).next('.block2-div').toggleClass('display');
        });

    });
    // 点击加入购物车，购物车数量和选择的数量一致
    function addCart(t) {

        var obj = t.parentNode.getElementsByTagName('input')[0];
        var productId  = $('#productId').val();
        var count = obj.value;
        $.ajax({
            url:'/trolley/addToTrolley',
            data:{productId:productId,count:count},
            success:function(data){
                console.log(data);
                if(data.responseCode == 1)
                    $('#addCartModal').modal();
                else if(data.responseCode == 2){
                    window.location.href = '/login';
                }else {
                    alert(data.resultMessage);
                }
            },error:function(){}
        })
    }
    // 删除购物车中的商品
    $('.js_deleteGoods').click(function (e) {
        e.stopPropagation();
        $(this).parent('li').remove();
    });

    /*--点击购物车部分--*/
    var $el = $("#js_showCart");
    var $cart = $('#shopCartBlock');
    var $showPerson = $("#js_showPerson");
    var $person = $("#personBlock");
    $el.click(function(e){
        e.stopPropagation();
        $cart.fadeToggle('fast');//  点击购物车标志，出现购物车
        $person.fadeOut('fast');
    });
    $showPerson.click(function(e){
        e.stopPropagation();
        $person.fadeToggle('fast');//  点击购物车标志，出现个人中心列表
        $cart.fadeOut('fast');
    });
    $(document).on('click',function(e){
        if(($(e.target) != $el) && (!$cart.is(':hidden'))){
            $cart.fadeOut('fast'); // 点击页面任何其他地方，购物车消失
        }
        if(($(e.target) != $showPerson) && (!$person.is(':hidden'))){
            $person.fadeOut('fast'); // 点击页面任何其他地方，个人中心
        }
    });
    /*--点击购物车部分-end!--*/




    //  点击加号，数字加一
    function m_subtract(t) {
        var obj = t.parentNode.getElementsByTagName('input')[0];
        if (obj.value > 1)
            obj.value--;
    }
    //  点击减号，数字减一
    function m_add(t) {
        var obj = t.parentNode.getElementsByTagName('input')[0];
        obj.value++;
    }
    //当屏幕向下滚时，导航栏固定在顶部
    $(window).scroll(function () {
        var scrollHeight = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;
        var scrollNavTop = $('#content')[0].offsetTop;
        if(scrollHeight >=  scrollNavTop-82){
            $('.header').removeClass('fixed-top');
            $('.pageNav').addClass('scrollNavFixed');
            $('.scrollBuyTo').css('visibility','visible');
        }else if (scrollHeight >  82 ) {
            $('.header').addClass('fixed-top');
            $('.pageNav').removeClass('scrollNavFixed');
            $('.scrollBuyTo').css('visibility','hidden');
        }else{
            $('.header').removeClass('fixed-top');
            $('.pageNav').removeClass('scrollNavFixed');
        }
    });
</script>

</body>
</html>